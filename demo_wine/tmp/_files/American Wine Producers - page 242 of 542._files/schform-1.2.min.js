const ZONE_WINE="wine";const ZONE_PRODUCT="product";const ZONE_BIZ="biz";const ZONE_MAGAZINE="magazine";const ZONE_REGION="region";const ZONE_GRAPE="grape";const ZONE_FOOD_WINE="food-wine";var solrSearchStart=1,pag_current=1,first_product=1,product_count=20;var ajaxCall=false;var qryURL="/ajax/ng/csearch/search";var zoneName=(typeof zone==="string")?zone:"";var catgry=(typeof catgry==="string")?catgry:"";var jsonPlholder=(typeof plholder==="object")?plholder:null;var selService=(typeof service==="string")?service.trim():"";var selCountry=(typeof country==="string")?country.trim():"";var selState=(typeof state==="string")?state.trim():"";var selCity=(typeof city==="string")?city.trim():"";function zonesConfig(){return{wine:{redirUrl:"",zoneNameShort:""},product:{redirUrl:"",zoneNameShort:""},biz:{redirUrl:"/biz",zoneNameShort:""},magazine:{redirUrl:"/magazine",zoneNameShort:"N"},region:{redirUrl:"/regions",zoneNameShort:"R"},grape:{redirUrl:"/grape-varieties",zoneNameShort:"G"},"food-wine":{redirUrl:"/food-wine",zoneNameShort:"F"}}}function getConfigValue(b,a){if(typeof zonesConfig()[b]==="undefined"){return null}else{return zonesConfig()[b][a]}}var browserStorageSupport=false;var storageData=false,mywinesdata=[];if(typeof(Storage)!=="undefined"){browserStorageSupport=true}else{browserStorageSupport=false}if(browserStorageSupport==true){try{mywinesdata=JSON.parse(localStorage.getItem("wswinesdata"));if(typeof mywinesdata!==undefined&&mywinesdata!==null){if(mywinesdata.length>0){storageData=true;for(var i=0;i<mywinesdata.length;i++){var wineObj=mywinesdata[i]}}}}catch(e){console.log(e)}}function useStorageData(){var a=getSearchCategory();if(storageData&&a==ZONE_WINE){return true}else{return false}}function initTypeahead(){var b=new Bloodhound({datumTokenizer:function(f){return Bloodhound.tokenizers.whitespace(useStorageData()?f.swd:"")},queryTokenizer:Bloodhound.tokenizers.whitespace,local:useStorageData()?mywinesdata:""});b.initialize();var a=new Bloodhound({datumTokenizer:function(f){return Bloodhound.tokenizers.whitespace(f.swd)},queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:"/ajax/ng/csearch/search?q=1&p=1",prepare:function(g,d){var h=getSearchCategory();if(h==ZONE_WINE||h==ZONE_PRODUCT){h=ZONE_WINE}if(h==ZONE_WINE){var f=extractVintageFromName();d.url+="&c="+h+"&k="+encodeURIComponent(f?g.replace(f,""):g)+"&v="+$("#Xwinename").attr("data-vintage")}else{d.url+="&c="+h+"&k="+encodeURIComponent(g)+"&s="+selService+"&co="+selCountry+"&st="+selState+"&ci="+selCity}return d},ajax:{beforeSend:function(){$(".typeahead").addClass("tt-loading")},complete:function(){$(".typeahead").removeClass("tt-loading")},cache:false}}});a.initialize();var c=$("#Xwinename").typeahead({hint:false,highlight:true,minLength:2},{name:"schphrases",displayKey:"swd",source:b?b.ttAdapter():null,limit:3,templates:{suggestion:function(d){return'<div class="schtxt"><div class="wntxt">'+d.swd+"</div></div>"}}},{name:"wines",displayKey:"swd",source:a.ttAdapter(),limit:20,templates:{header:function(d){var f=getSearchCategory();if(f==ZONE_WINE){return'<div class="typeahead-group-name">Search suggestions...</div>'}},suggestion:function(d){var f=getSearchCategory();if(f==ZONE_WINE||f==ZONE_PRODUCT){f=ZONE_WINE}if(f==ZONE_WINE){return'<div class="'+d.s+'"><div class="wnicon"><span class="'+d.c+'"></span></div><div class="wntxt">'+d.swd+", <small>"+d.r+"</small></div></div>"}else{if(f==ZONE_GRAPE){return'<div><div class="wnicon"><span class="'+d.c+'"></span></div><div class="wntxt">'+d.n+"</div></div>"}else{if(f==ZONE_BIZ){return'<div><div class="wntxt">'+d.i+d.n+"</div></div>"}else{if(f===ZONE_MAGAZINE){return'<div><div class="wntxt">'+d.n+" by "+d.a+"</div></div>"}else{return'<div><div class="wntxt">'+d.n+"</div></div>"}}}}},footer:function(d){return'<div class="footer-message">Press Enter to search.</div>'}}});c.on("typeahead:selected",function(g,f){var h=getSearchCategory();if(h==ZONE_WINE||h==ZONE_PRODUCT){h=ZONE_WINE}if(h==ZONE_WINE){if(typeof(f.w)!=="undefined"&&typeof(f.i)!=="undefined"){c.off("change");$("#winenameid").val(f.i);$("#winename").val(f.w);$("#winenamedisplay").val(f.swd)}else{$("#winename").val(f.w);$("#winenamedisplay").val(f.swd)}var d=$("#Xwinename").data("vintage");if(d){$("#Xvintage").val(d)}search_button_click()}else{window.location.href=f.link}return false});c.on("change",function(g,f){if(!f){var d=$.trim($(".typeahead").val());$("#winename").val(d);$("#winenamedisplay").val(d);$("#winenameid").val("")}return false});c.on("typeahead:open",function(d){var f=$(d.currentTarget);if(!f.data("wasFocused")){f.data("wasFocused",true);f.typeahead("close")}});c.on("typeahead:close",function(d){$(d.currentTarget).removeData("wasFocused")});c.on("keydown",function(d){$(d.currentTarget).data("wasFocused",true)})}initTypeahead();$("#Xcategory").change(function(){var b=getSearchCategory();var a=jsonPlholder[b];if(a){$("#Xwinename").attr("placeholder",a)}$("#Xwinename").typeahead("destroy");initTypeahead()});function saveWinesData(j,d){if(typeof(browserStorageSupport)!="undefined"&&browserStorageSupport==true){try{if(typeof(JSON.parse(localStorage.getItem("wswinesdata")))!==undefined&&JSON.parse(localStorage.getItem("wswinesdata"))!==null){var a=JSON.parse(localStorage.getItem("wswinesdata"))||[];if(a.length>0){for(var f=0;f<a.length;f++){var b=a[f].w;var l=a[f].swd;if((b.toLowerCase()===j.toLowerCase())||(l.toLowerCase()===j.toLowerCase())){a.splice(f,1);break}}localStorage.wswinesdata=JSON.stringify(a);var c=new Object();c.swd=d;c.w=j;a.unshift(c);localStorage.wswinesdata=JSON.stringify(a);localStorage.setItem("wswinesdata",JSON.stringify(a))}}else{var a=[];var c=new Object();c.swd=d;c.w=j;a.unshift(c);localStorage.setItem("wswinesdata",JSON.stringify(a))}}catch(h){if(h.name.toUpperCase().indexOf("QUOTA")>=0){console.log("Sorry, your browser local storage limit exceeds, please free some storage space.")}else{var g=new RegExp("wswinesdata");if(localStorage.length>0){for(var k in localStorage){if(g.test(k)==true){localStorage.removeItem(k);try{var a=[];var c=new Object();c.swd=d;c.w=j;a.unshift(c);localStorage.setItem("wswinesdata",JSON.stringify(a))}catch(h){}}}}console.log("There is something wrong with local storage data, please try again.")}}}}var processing=0;var flds_tidy=false;function search_button_click(){if(processing==1){return false}else{var a=getSearchKeywords();if(hasAsianCharacter(a)){alert("Sorry, we do not understand searches in Asian scripts.\n很抱歉，我们无法理解亚洲文字中的搜寻字词。\n죄송합니다, 우리는 아시아 스크립트에서 검색을 이해하지 못하는.\n申し訳ありませんが、アジアのスクリプトでの検索を理解していません.");return false}var b=getSearchCategory();if(b==ZONE_WINE||b==ZONE_PRODUCT){searchProduct()}else{searchContent(a,b)}return false}}function searchProduct(){underneathProgressBar($("#progressBarHolder"));processing=1;if(!flds_tidy){tidySchFlds()}var a=constructFind();window.setTimeout(function(){window.location.href=a},1000,a)}function tidySchFlds(){var b=false;var a=new Array("wine name","nom du vin","nome del vino","name des weins","nombre del vino");b=a.toString().indexOf($("#Xwinename").val().toLowerCase())>-1;if(b){$("#Xwinename").val("")}b=false;var a=new Array("vintage","vint","année","annata","jahr","cosecha");if(typeof($("#Xvintage").val())!="undefined"){b=a.toString().indexOf($("#Xvintage").val().toLowerCase())>-1;if(b){$("#Xvintage").val("")}}if(typeof($("#Xprice_min").val())!="undefined"){if($("#Xprice_min").val().toString().toLowerCase()=="min"){$("#Xprice_min").val("")}if($("#Xprice_max").val().toString().toLowerCase()=="max"){$("#Xprice_max").val("")}if($("#Xprice_min").val()!=""&&$("#Xprice_max").val()!=""&&$("#Xprice_min").val()!="Min"&&$("#Xprice_max").val()!="Max"){if(parseInt($("#Xprice_min").val())>parseInt($("#Xprice_max").val())){var c=$("#Xprice_min").val();$("#Xprice_min").val($("#Xprice_max").val());$("#Xprice_max").val(c)}}}flds_tidy=true}function show_shipto(){styleObj=document.getElementById("Xshiptoid").style;if(document.searchform.Xlocation.value=="USA"&&document.searchform.Xstate.value!=""&&document.searchform.Xstate.value!="ANY"&&document.searchform.Xstate.value!="R."&&(usingMobile||(document.searchform.Xstate.value!="ZC"&&!usingMobile))){styleObj.display=""}else{styleObj.display="none"}if(!usingMobile){if(document.searchform.Xlocation.value=="USA"&&document.searchform.Xstate.value=="ZC"){show_zip()}else{hide_zip()}}if(document.searchform.Xstate.value!=""&&document.searchform.Xstate.value!="ANY"&&(usingMobile||(document.searchform.Xstate.value!="ZC"&&!usingMobile))){document.searchform.Xzipcode.value="";$("#Xzipcode__clear").css("visibility","hidden");$(".formplaceholder").addPlaceholder()}}function show_zip_new(){styleObj=document.getElementById("XzipDiv").style;if(document.searchform.Xlocation.value=="USA"){styleObj.display=""}else{styleObj.display="none"}}function show_states_new(){styleObj=document.getElementById("USAstatezip").style;if(document.searchform.Xlocation.value=="USA"){styleObj.display=""}else{styleObj.display="none"}show_shipto();show_zip_new()}function show_zip(){styleObj=document.getElementById("Xziplabelid").style;if(usingMobile){if(document.searchform.Xlocation.value=="USA"){styleObj.display="block"}else{styleObj.display="none"}}else{styleObj.display="inline-block"}styleObj=document.getElementById("Xzipdetailid").style;if(usingMobile){if(document.searchform.Xlocation.value=="USA"){styleObj.display="block"}else{styleObj.display="none"}}else{styleObj.display="inline-block"}$(".formplaceholder").addPlaceholder()}function hide_zip(){styleObj=document.getElementById("Xziplabelid").style;styleObj.display="none";styleObj=document.getElementById("Xzipdetailid").style;styleObj.display="none";document.searchform.Xzipcode.value=""}function show_states(){if(usingMobile){o=document.getElementById("Xstates");if(o){styleObj=o.style;if(document.searchform.Xlocation.value=="USA"){styleObj.display="block"}else{styleObj.display="none"}styleObj=document.getElementById("Xstateid").style;if(document.searchform.Xlocation.value=="USA"){styleObj.display="";$("#searchblock").removeClass("searchblock").addClass("searchblock-alt")}else{styleObj.display="none";$("#searchblock").removeClass("searchblock-alt").addClass("searchblock")}show_shipto();show_zip()}}else{styleObj=document.getElementById("Xstateid").style;if(document.searchform.Xlocation.value=="USA"){styleObj.display=""}else{styleObj.display="none"}show_shipto()}}function reset_fld(a){var b=document.getElementById(a);b.className=b.className.replace("inputdefault","");if(b.value=="email@example.com"||b.value=="password"){b.value=""}}function resetFldDefault(a){$("#"+a.replace("__clear","")).val("");if((a.replace("__clear","")=="Xwinename")||(a.replace("__clear","")=="Xsearchregion")||(a.replace("__clear","")=="Xsearchgrape")||(a.replace("__clear","")=="Xsearchmerchant")||(a.replace("__clear","")=="Xsearcharticle")){$(".typeahead").typeahead("val","")}$("#"+a.replace("__clear","")).focus()}$(function(){$(".sch-main-fld-clear,.sch-zip-fld-clear").mousedown(function(a){$(this).css("visibility","hidden");resetFldDefault($(this).attr("id"));a.preventDefault()})});$(function(){$(".formplaceholder").focus(function(){var b=false;var a=new Array("wine name","nom du vin","nome del vino","name des weins","nombre del vino","vintage","vint","année","annata","jahr","cosecha","email@example.com","password","zip code");b=a.toString().indexOf($(this).val().toLowerCase())>-1;if(b){$(this).val("")}if($(this).val()!=""){$("#"+$(this).attr("id")+"__clear").css("visibility","visible")}})});$(function(){var a="";if(usingMobile){a=".sch-fld-main,.sch-fld-zip,.sch-fld-price-min,.sch-fld-price-max"}else{a=".sch-fld-main,.sch-fld-zip"}$(a).keyup(function(){if($(this).val()!=""){$("#"+$(this).attr("id")+"__clear").css("visibility","visible")}else{$("#"+$(this).attr("id")+"__clear").css("visibility","hidden")}})});$(function(){$(document).ready(function(){if(typeof($("#Xlocation").val())!="undefined"){if($("#Xlocation").val()=="USA"){if(usingMobile){show_states()}else{if(schfull==="Y"){show_states()}}}}})});function constructFind(){var f="/";var Q;if($("#winename").val()!=""){Q=$("#winename").val().toLowerCase()}else{Q=$("#Xwinename").val().toLowerCase()}var L=$("#winenamedisplay").val();var B=0;if(L.toLowerCase()===Q.toLowerCase()){var B=1}var k="";var b="";if(typeof($("#Xvintage").val())!="undefined"){k=$("#Xvintage").val().toLowerCase();b=$("#Xvintage").val().toLowerCase()}var r="";var s="";if(typeof($("#Xlocation").val())!="undefined"){r=$("#Xlocation").val().toLowerCase()}if(usingMobile){if(typeof($("#Xkeyword_mode").val())!="undefined"){s=$("#Xkeyword_mode").val().toLowerCase();if(s=="aut"){s="a"}}}else{if(typeof($("input:radio[name ='Xkeyword_mode1']:checked").val())!="undefined"){s=$("input:radio[name ='Xkeyword_mode1']:checked").val().toLowerCase();if(s=="aut"){s="a"}}else{if(typeof($("input:radio[name ='Xkeyword_mode']:checked").val())!="undefined"){s=$("input:radio[name ='Xkeyword_mode']:checked").val().toLowerCase()}}}if(getSearchKeymode()!==""){s=getSearchKeymode()}var p=$("#Xwinenameid").val();var M="";var I="";var q="";var H="";var v="";var y;var F=new Date();var z;var g="";var A="";var R="";var S="";var x="";var l="";if(document.getElementById("show_favourite")!=null){l=document.getElementById("show_favourite").value}var G=" "+Q.toLowerCase()+" ";G=G.replace(/\+/g," ");G=G.replace(/'s[,.!;-] /g,"s ");G=G.replace(/'s[)(":\/] /g,"s ");G=G.replace(/'s /g,"s ");G=G.replace(/´s /g,"s ");G=G.replace(/’s /g,"s ");G=G.replace(/\u2019s /g,"s ");G=G.replace(/`s /g,"s ");G=G.replace(/\./g," ");G=accentConverter(G);if(typeof String.prototype.trim!=="function"){Q=G.replace(/^\s+|\s+$/g,"")}else{Q=G.trim()}var t="";for(var K=1;K<=Q.length;K++){var O=Q.substr(K-1,1);if(O==String.fromCharCode(38)||O=="/"||O=="?"||O=="="||O=="%"||O==","){t=t+" "}else{t=t+O}}t=t.replace(/[^a-z0-9' -]/g,"").replace(/\s+/g,"+").replace(/-+/g,"-");Q=t;if(k.length>4){b="1"}else{var D=F.getFullYear();var d=Math.floor(F.getFullYear()/100)*100;var C=F.getFullYear()-d;var u="";z="Y";for(var K=1;K<=k.length;K++){var O=k.substr(K-1,1);if((O>="0"&&O<="9")||O=="n"||O=="v"||O=="a"||O=="l"){u=u+O;if(O=="n"||O=="v"||O=="a"||O=="l"){z="N"}}}if(u==""){b=1}else{if(u=="NV"||u=="nv"){b=0}else{if(u=="ALL"||u=="all"){b=1}else{if(u=="N"||u=="n"){b=1}else{if(u=="0"||u=="1"||u=="2"){b=u}else{if(parseInt(u)>C&&parseInt(u)<100){b=parseInt(u)+(d-100)}else{if(parseInt(u)>=0&&parseInt(u)<=C){b=parseInt(u)+(d)}else{if(parseInt(u)>99&&(parseInt(u)<1699||parseInt(u)>D)){b=1}else{b=u}}}}}}}}}for(var P=1;P<=3;P++){for(var K=1;K<=Q.length-4;K++){var z="Y";for(var J=1;J<=Q.length-K+1;J++){var O=Q.substr(K+J-2,1);if(O>="0"&&O<="9"){z="Y"}else{z="N";break}}if(J>5||z=="Y"){if(K==1&&z=="Y"){Q=""}else{if(K==1){Q=Q.substr(K+J-2)}else{if(z=="Y"){Q=Q.substr(0,K-1)}else{Q=Q.substr(0,K-1)+Q.substr(K+J-2)}}}break}}}Q=Q.replace(" "," ");if(Q.substr(0,1)==" "||Q.substr(0,1)=="+"){Q=Q.substr(1)}if(Q.substr(Q.length-1,1)==" "||Q.substr(Q.length-1,1)=="+"){Q=Q.substr(0,Q.length-1)}if(B===0){saveWinesData(Q.replace(/\+/g," "),L)}else{if(B===1){saveWinesData(Q.replace(/\+/g," "),Q.replace(/\+/g," "))}}if(r=="ANY"||r=="any"||r==""){r="-"}y=r;if(r=="usa"){R=$("#Xstateid").val();if(usingMobile){if(R=="ANY"){R=""}}else{if(R=="ANY"||R=="ZC"){R=""}}S="";if($("#Xshipto").is(":checkbox")){if(document.searchform.Xshipto.checked){S="y"}}else{if($("#Xshipto").prop("type")=="hidden"&&$("#Xshipto").val()=="Y"){S="y"}}if(R=="R."||R=="ANY"||R==""){S=""}var w=$("#Xzipcode").val();var E="";for(var K=1;K<=w.length;K++){var O=w.substr(K-1,1);if(O>="0"&&O<="9"){E=E+O}}A=E;if(A!=""){R="";S="";if($("#Xzipmiles").prop("type")=="hidden"){g=$("#Xzipmiles").val()}else{g=document.searchform.Xzipmiles.options[document.searchform.Xzipmiles.selectedIndex].value}var n="";for(var K=1;K<=g.length;K++){var O=g.substr(K-1,1);if(O>="0"&&O<="9"){n=n+O}}g=n}else{g=""}var N=r;if(A>0){if(g>0){N=r+"-"+A+"-"+g}else{N=r+"-"+A}}else{if(R!=""&&typeof R!="undefined"&&R!="ALL"&&R!="ANY"&&(usingMobile?true:(R!="ZC"))){if(S=="y"){N=r+"-"+R+"-"+S}else{N=r+"-"+R}}}y=N}else{R="";S="";A="";g="";N=""}if(typeof document.searchform.Xbottle_size!="undefined"){M=document.searchform.Xbottle_size.options[document.searchform.Xbottle_size.selectedIndex].value}if(typeof $("#Xprice_min").val()!="undefined"){q=$("#Xprice_min").val()}if(typeof $("#Xprice_max").val()!="undefined"){H=$("#Xprice_max").val()}if(typeof document.searchform.Xprice_set!="undefined"){I=document.searchform.Xprice_set.options[document.searchform.Xprice_set.selectedIndex].value}if(typeof $("#searchsortorder").val()!="undefined"){x=$("#searchsortorder").val()}var h="N";for(var K=1;K<=A.length;K++){var O=A.substr(K-1,1);if(O>"9"||O<"0"){h="Y"}}if(h=="Y"||A.length!=5){A="";g=""}else{var m="N";for(var K=1;K<=g.length;K++){var O=g.substr(K-1,1)}if(O>"9"||O<"0"){m="Y"}if(m=="Y"){g=""}}if(M!="all"&&M!="Bottle"&&M!="Half Bottle"&&M!="H/Bottle (375ml)"&&M!="Magnum"&&M!="D-magnum (3L)"&&M!="Case"&&M!="other"){M=""}if(I!="CUR"&&I!="M01"&&I!="M02"&&I!="M03"&&I!="Y01"&&I!="Y02"&&I!="Y03"&&I!="Y04"){I=""}if(Q===""){Q="-"}if(b===""){b="1"}if(typeof r=="undefined"||r==""){r="-"}if(typeof s=="undefined"||s==""||s=="a"){s="-"}if(M!=""||I!=""||q!=""||H!=""||l!=""){v="?Xbottle_size="+M+"&Xprice_set="+I+"&Xprice_min="+q+"&Xprice_max="+H+"&Xshow_favourite="+l}else{v=""}if(typeof $("#forcesort").val()!="undefined"&&$("#forcesort").val()=="Y"){if(x!=""){if(v==""){v+="?"}else{v+="&"}v+="Xsort_order="+x}}target="find/";if(typeof p=="undefined"||p==""||p==0){if(s=="-"){if(r=="-"){if(b=="1"){f="/"+target+escape(Q).replace(/%20/g,"+")+v}else{f="/"+target+escape(Q).replace(/%20/g,"+")+"/"+b+v}}else{f="/"+target+escape(Q).replace(/%20/g,"+")+"/"+b+"/"+escape(y).replace(/%20/g,"+").toLowerCase()+v}}else{f="/"+target+escape(Q).replace(/%20/g,"+")+"/"+b+"/"+escape(y).replace(/%20/g,"+").toLowerCase()+"/-/"+s+v}}else{f="/"+target+escape(Q).replace(/%20/g,"+")+"/"+b+"/"+escape(y).replace(/%20/g,"+").toLowerCase()+"/-/"+s+"/-/"+p+v}return f}$(document).ready(function(){if(typeof($("#schSortOrder").val())!="undefined"){$("#schSortOrder").change(function(a){$("#searchsortorder").val(a.target.value);$("#forcesort").val("Y");search_button_click()})}});function extractVintageFromName(){var a=$("#Xwinename");var b="";var c=/^\d{4}\s*/;var d=c.exec(a.val());if(d){b=parseInt(d[0]);if(!isValidVintage(b)){b=""}}if(!b){c=/\d{4}\s*$/;d=c.exec(a.val());if(d){b=parseInt(d[0]);if(!isValidVintage(b)){b=""}}}if(b){a.attr("data-vintage",b);return c}else{a.attr("data-vintage","");return}}function isValidVintage(b){var c=new Date();var a=c.getFullYear();return(b>1784&&b<=a)}function getSearchKeywords(){var a=$("#winename").val().trim();if(a==""){a=$("#Xwinename").val().trim()}return htmlspecialchars(a)}function getSearchCategory(){return typeof $("#Xcategory option:checked").val()=="undefined"?ZONE_WINE:$("#Xcategory option:checked").val()}function validateCatgry(){if(typeof zonesConfig()[catgry]==="undefined"){return false}else{return true}}function getSearchKeymode(){var a="";if(zoneName){if(getSearchCategory()=="product"){a="x"}else{if(getSearchCategory()=="wine"){a="a"}}}return a}$("#solr-form").not("#pjax-rating-list #solr-form").hide();if(zoneName){if(getSearchKeywords()!=""&&validateCatgry()){var keymode=getSearchKeymode();searchContent(getSearchKeywords(),getSearchCategory(),keymode)}}function searchContent(d,f,c){if(zoneName!=f||!$("#solr-form").length){if(f==ZONE_WINE||f==ZONE_PRODUCT){searchProduct()}else{var b=getConfigValue(f,"redirUrl")+"?q="+encodeURIComponent(d)+"&c="+f;window.location.href=b}return false}pag_current=1;solrSearchStart=1;if(d!=""){$(".tt-menu").css("display","none");$(".typeahead").typeahead("close");var a="q=2&p="+solrSearchStart+"&c="+f+"&k="+d+"&s="+selService+"&co="+selCountry+"&st="+selState+"&ci="+selCity;ajaxGetContentSearch(a)}if(ajaxCall==true){return false}}function ajaxGetContentSearch(a){$.ajax({type:"get",url:qryURL,data:a,success:function(c,b,d){ajaxCall=true;showResults(c);showPagers(c)},error:function(){ajaxCall=false}})}function showResults(a){$("#solr-form").show();$("#solr-result").html(a)}function showPagers(d){var b=window.location;var f=0,p=0,n=0,g=1,m;var n=parseInt($("#matching-found").html());if(n>product_count){p=n%product_count;f=Math.floor(n/product_count);if(p>0){f=f+1}else{if(p==0){f=f}}}else{f=1}if(f>1){m=f;var q='<div id="pagers" class="pager-container">Page: ';var a="";var j=11,h,c=0,l=0,k;if(pag_current>1){if(first_product-product_count<=1){k=1}else{k=((pag_current-2)*product_count)+1}a='<a class="pager" title="Previous page"  href="" rel="'+(pag_current-1)+'">&lt;</a> ';j=j-1}if(pag_current<m){j=j-1}if(m>j){if(pag_current>=(j-3)){c=1}if(pag_current<(m-(j-4))){l=1}}var t=pag_current-Math.floor((j-4)/2)-3;for(var r=1;r<j;r++){if(r==1){h=1}else{if(r==j){h=m}else{if(r==2&&c){h=-1}else{if(r==(j-1)&&l){h=0}else{if(!c){h=r}else{if(!l){h=m-(j-r)}else{h=t+r}}}}}}if(h==-1){a=a+"- "}else{if(!h){a=a+"of "}else{if(h==pag_current){a=a+'<span class="currentpage">'+h+"</span> "}else{a=a+'<a class="pager" href="" rel="'+h+'">'+h+"</a> "}}}if(h==m){break}}if(f>10){a=a+'<a class="pager" href="" rel="'+f+'">'+f+"</a> "}if(pag_current<m){a=a+'<a class="pager" title="Next page" href="" rel="'+(pag_current+1)+'">&gt;</a> '}a=q+a+"</div>"}if(n>0){$("#pagers").remove();$("#solr-result").append(a)}}function toggleXbtn(c,b){var a=$(c).val();a=a?a.trim():"";if(a==""){$(b).css("visibility","hidden")}else{$(b).css("visibility","visible")}}function logSearch(f,c,d){var a="/ajax/ng/log-search/log";var b={search_type:f,search_name:c,top_result:d};$.ajax({type:"get",url:a,data:b,success:function(h,g,j){},error:function(g){}})}$(".sch-fld-main").on("keyup mouseup focus",function(){var a=$(this).parents("div").find(".xbtn");toggleXbtn(this,a)}).on("paste",function(){var b=$(this).parents("div").find(".xbtn");var a=this;setTimeout(function(){toggleXbtn(a,b)},100)});$(".xbtn").on("mousedown",function(b){var a=$(this).parents("div").find("#Xwinename");if(reqTypeahead){$(a).typeahead("val","").blur().focus()}else{$(a).val("")}toggleXbtn(a,this)});$("#solr-form").on("click","#pagers .pager",function(b){b.preventDefault();pag_current=parseInt($(this).attr("rel"));solrSearchStart=pag_current*product_count-product_count+1;first_product=solrSearchStart;var a="q=2&p="+pag_current+"&c="+getSearchCategory()+"&k="+$("#Xwinename").val().trim()+"&s="+selService;ajaxGetContentSearch(a);$body=(window.opera)?(document.compatMode=="CSS1Compat"?$("html"):$("body")):$("html,body");$body.stop().animate({scrollTop:$("#solr-result").offset().top},"slow")});function htmlspecialchars(b){var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return b.replace(/[&<>"']/g,function(c){return a[c]})}function htmlspecialchars_decode(b){var a={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};return b.replace(/(&amp;|&lt;|&gt;|&quot;|&#39;)/g,function(c){return a[c]})}function htmlentities(b){var a=document.createElement("textarea");a.innerHTML=b;return a.innerHTML}function htmlentities_decode(b){var a=document.createElement("textarea");a.innerHTML=b;return a.value}function searchtoggle(h,b,g){var d,c,k;var j=document.getElementById(g);var f=document.getElementById(b);var a=document.getElementById("sch-toggle");if(a.className=="sch-toggle"){a.className="sch-toggle-hide"}else{a.className="sch-toggle"}if(h.indexOf("|")>-1){d=h.split("|");c=d.length}else{c=1}for(i=0;i<c;i++){k=c==1?document.getElementById(h):document.getElementById(d[i]);if(k.style.display=="block"){f.className="ico-expand";k.style.display="none";j.innerHTML=j.innerHTML.replace("Hide","Show")}else{f.className="ico-collapse";k.style.display="block";j.innerHTML=j.innerHTML.replace("Show","Hide")}}}if(usingMobile){$(function(){var a=$("#searchform").width();if(a<420){a=a+"px";$("#searchform .tt-menu").css("width",a);$("#gsearchbox .tt-menu").css("marginLeft","-36px")}else{$("#searchform .tt-menu").css("width","100%")}$("#solr-form").on("keyup",".typeahead",function(b){if((b.keyCode?b.keyCode:b.which)==13){$(".typeahead").typeahead("close")}});$("#searchform").on("keyup",".typeahead",function(b){if((b.keyCode?b.keyCode:b.which)==13){$(".typeahead").typeahead("close")}})})}if(usingMobile){$(document).on("mouseup keyup",".searchbox-hp #Xwinename",function(b){var a=document.getElementById("Xwinename");a.scrollIntoView()})};